<form [formGroup]="diagForm" (ngSubmit)="onSubmit()" (keydown.enter)="$event.preventDefault()">
  <div class='indication-container' fxLayout fxLayoutAlign="center center">
    <mat-form-field class='indication'>
      <input matInput style='text-align:center' placeholder='Indication' formControlName='indication' />
    </mat-form-field>
  </div>


  <table formArrayName="prescribed_drugs" style='width:100%'>
      <tr *ngFor="let prescribed_drug of prescribed_drugs.controls; let i=index" [formGroupName]='i' fxLayout fxLayoutGap='5px' fxLayoutAlign='stretch stretch'>
        <td fxFlex>
          <app-auto-complete [source]=drugs
                              placeholder='Drug'
                              display-attr='trade_name'
                              value-attr='id'
                              (onSelected)="onDrugSelect($event,i)"></app-auto-complete>
        </td>
        <td fxFlex>
          <mat-form-field>
            <input matInput formControlName="quantity" placeholder="Quantity"/>
          </mat-form-field>
        </td>
        <td fxFlex>
          <mat-form-field>
            <input matInput formControlName="comments" placeholder='Comments'/>
          </mat-form-field>
        </td>
        <td fxFlex>
          <button matButton mat-mini-fab color='warn' (click)="deleteRow(i)">x</button>
        </td>
      </tr>
  </table>
  <div fxLayout fxLayoutAlign='center end' fxLayoutGap='10px' >
    <button mat-raised-button color='primary' type='button' (click)='addRow()'>Add Drug </button>
    <button *ngIf="diagForm.status=='VALID'" mat-raised-button color='warn' type='submit'>Submit</button>
  </div>
</form>
<!-- {{diagForm.value | json}} {{diagForm.status | json}} -->
